## Evaluating p-values
The objective of this project was to evaluate the effectiviness of different p-value methods. Using the some of the data from the following publication:
Elias D, Vever H, Lænkholm AV, et al. *Gene expression profiling
identifies FYN as an important molecule in tamoxifen resistance and a
predictor of early recurrence in patients treated with endocrine
therapy* \[published correction appears in Oncogene. 2018
Oct;37(41):5585-5586\]. Oncogene. 2015;34(15):1919‐1927.
<doi:10.1038/onc.2014.138>
#install.packages("BiocManager")
library(BiocManager)
#BiocManager::install("Biobase")
#BiocManager::install("GEOquery")
# Debería haber instalado "genefilter" para los ejercicios del curso en edX.
# Si no lo ha instalado elimine el comentario de la siguiente instruccion
#BiocManager::install("genefilter")
library(GEOquery)
library(genefilter)
gset <- getGEO("GSE67916", GSEMatrix =TRUE, getGPL=FALSE)
# gset es una lista con un solo elemento, así que nos quedaremos con ese elemento
gset<-gset[[1]]
# gset pasa a ser un objeto de expresión manejado por Bioconductor.
class(gset)
abstract(experimentData(gset))
matexpr<-exprs(gset)
dim(matexpr)
pdata<-pData(phenoData(gset))
g=factor(pdata$`tamoxifen sensitivity:ch1`)
summary(g)
rowttestD <- rowttests(matexpr, g)$p.value
sum(rowttestD < 0.05)
lthanfv <- sum(rowttestD < 0.05)
xlab_description <- c(paste("p-valores menores a 0.05, desde la columna vertical a la iszquierda\n  con un total de = " , lthanfv , sep=""))
par(bg = 'aliceblue')
hist(rowttestD, freq=F, xlab = xlab_description, ylab = "Densidad", col = "lightblue", border = "cadetblue", main = "Histograma de Pruebas T")
abline(h=1 , col="red")
abline(v=0.5, col="green", lty=2, lwd=3)
lthanfv <- sum(rowttestD < 0.05)
xlab_description <- c(paste("p-valores menores a 0.05, desde la columna vertical a la iszquierda\n  con un total de = " , lthanfv , sep=""))
par(bg = 'aliceblue')
hist(rowttestD, freq=F, xlab = xlab_description, ylab = "Densidad", col = "lightblue", border = "cadetblue", main = "t-test Histogram")
abline(h=1 , col="red")
abline(v=0.5, col="green", lty=2, lwd=3)
lthanfv <- sum(rowttestD < 0.05)
xlab_description <- c(paste("p-values less than 0.05, seen from left green vertical column to the left\n Total = " , lthanfv , sep=""))
par(bg = 'aliceblue')
hist(rowttestD, freq=F, xlab = xlab_description, ylab = "Densidad", col = "lightblue", border = "cadetblue", main = "t-test Histogram")
abline(h=1 , col="red")
abline(v=0.5, col="green", lty=2, lwd=3)
lthanfv <- sum(rowttestD < 0.05)
xlab_description <- c(paste("p-values less than 0.05, seen from left green vertical line to the left\n Total = " , lthanfv , sep=""))
par(bg = 'aliceblue')
hist(rowttestD, freq=F, xlab = xlab_description, ylab = "Densidad", col = "lightblue", border = "cadetblue", main = "t-test Histogram")
abline(h=1 , col="red")
abline(v=0.5, col="green", lty=2, lwd=3)
lthanfv <- sum(rowttestD < 0.05)
xlab_description <- c(paste("p-values less than 0.05, present to the left green line\n Total = " , lthanfv , sep=""))
par(bg = 'aliceblue')
hist(rowttestD, freq=F, xlab = xlab_description, ylab = "Densidad", col = "lightblue", border = "cadetblue", main = "t-test Histogram")
abline(h=1 , col="red")
abline(v=0.5, col="green", lty=2, lwd=3)
lthanfv <- sum(rowttestD < 0.05)
xlab_description <- c(paste("p-values less than 0.05, present to green line left side\n Total = " , lthanfv , sep=""))
par(bg = 'aliceblue')
hist(rowttestD, freq=F, xlab = xlab_description, ylab = "Densidad", col = "lightblue", border = "cadetblue", main = "t-test Histogram")
abline(h=1 , col="red")
abline(v=0.5, col="green", lty=2, lwd=3)
lthanfv <- sum(rowttestD < 0.05)
xlab_description <- c(paste("p-values less than 0.05, present to green line left side\n Total = " , lthanfv , sep=""))
par(bg = 'aliceblue')
hist(rowttestD, freq=F, xlab = xlab_description, ylab = "Density", col = "lightblue", border = "cadetblue", main = "t-test Histogram")
abline(h=1 , col="red")
abline(v=0.5, col="green", lty=2, lwd=3)
lthanfv <- sum(rowttestD < 0.05)
xlab_description <- c(paste("p-values\n Total = " , lthanfv , sep=""))
par(bg = 'aliceblue')
hist(rowttestD, freq=F, xlab = xlab_description, ylab = "Density", col = "lightblue", border = "cadetblue", main = "t-test Histogram")
abline(h=1 , col="red")
abline(v=0.5, col="green", lty=2, lwd=3)
